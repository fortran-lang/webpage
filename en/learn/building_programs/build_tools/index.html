
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Build tools &#8212; Fortran Programming Language</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="icon" sizes="256x256" type="image/ico" href="../../../_static/images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="An introduction to make" href="../project_make/" />
    <link rel="prev" title="Managing libraries (static and dynamic libraries)" href="../managing_libraries/" /> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
  var pr_number = -1;
  $(document).ready(function () {
    if (window.location.href.indexOf("/pr/") > -1) {
      pr_number = window.location.href.split("/").indexOf("pr") + 1;
      document.getElementById("pr").innerHTML =
        "pull request " + window.location.href.split("/")[pr_number];
      document.getElementById("pr").href =
        "https://github.com/fortran-lang/webpage/pull/" +
        window.location.href.split("/")[pr_number];
      var banner = document.getElementById("banner");
      banner.style.display = "block";
    }
  });
</script>
<div id="banner" style="display: none" class="container">
  <h3>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="feather feather-git-pull-request"
    >
      <circle cx="18" cy="18" r="3"></circle>
      <circle cx="6" cy="6" r="3"></circle>
      <path d="M13 6h3a2 2 0 0 1 2 2v7"></path>
      <line x1="6" y1="9" x2="6" y2="21"></line>
    </svg>
    <b>Site preview: </b>you are previewing unpublished changes for
    <a id="pr"></a>
  </h3>
</div> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../news/atom.xml"
  title="Blog"
/>
 
<link href="True" rel="stylesheet" />

<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../">
  
  
  
  
    <img src="../../../_static/fortran-logo-256x256.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../_static/fortran-logo-256x256.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
    <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
    
    <div class="dropdown" id="version_switcher">
  <button
    type="button"
    class="btn btn-sm navbar-btn dropdown-toggle"
    id="version_switcher_button"
    data-toggle="dropdown"
  >
    en
    <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div
    id="version_switcher_menu"
    class="dropdown-menu list-group-flush py-0"
    aria-labelledby="version_switcher_button"
  >
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables learn/building_programs/build_tools and {'json_url': 'https://fortran-lang.org/', 'version_match': 'en'}.
-->

<script type="text/javascript">
  // Check if corresponding page path exists in other version of docs
  // and, if so, go there instead of the homepage of the other docs version
  function checkPageExistsAndRedirect(event) {
    const currentFilePath = "learn/building_programs/build_tools",
      tryUrl = event.target.getAttribute("href");
    location.href = tryUrl;
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
  }

  // Populate the version switcher from the JSON config file
  (function () {
    const currentFilePath = "learn/building_programs/build_tools";
    const indexFilePath = "../../../";
    let btn = document.getElementById("version_switcher_button");
    // Set empty strings by default so that these attributes exist and can be used in CSS selectors
    btn.dataset["activeVersionName"] = "";
    btn.dataset["activeVersion"] = "";
    // create links to the corresponding page in the other docs versions
    data = [
      {
        name: "English",
        version: "en",
        url: "../en/",
      },
      {
        name: "bn",
        version: "bn",
        url: "../bn/",
      },
      {
        name: "cs",
        version: "cs",
        url: "../cs/",
      },
      {
        name: "Deutsch",
        version: "de",
        url: "../de/",
      },
      {
        name: "Español",
        version: "es",
        url: "../es/",
      },
      {
        name: "Français",
        version: "fr",
        url: "../fr/",
      },
      {
        name: "ja",
        version: "ja",
        url: "../ja/",
      },
      {
        name: "Nederlands",
        version: "nl",
        url: "../nl/",
      },
      {
        name: "pl",
        version: "pl",
        url: "../pl/",
      },
      {
        name: "Português",
        version: "pt",
        url: "../pt/",
      },
      {
        name: "Русский",
        version: "ru",
        url: "../ru/",
      },
      {
        name: "简体中文",
        version: "zh_CN",
        url: "../zh_CN/",
      },
    ];
    console.log(data);
    $.each(data, function (index, entry) {
      // if no custom name specified (e.g., "latest"), use version string
      if (!("name" in entry)) {
        entry.name = entry.version;
      }
      // create the node
      const node = document.createElement("a");
      node.setAttribute("class", "list-group-item list-group-item-action py-1");
      node.textContent = `${entry.name}`;
      node.setAttribute(
        "href",
        `${indexFilePath}${entry.url}${currentFilePath}`,
      );
      // on click, AJAX calls will check if the linked page exists before
      // trying to redirect, and if not, will redirect to the homepage
      // for that version of the docs.
      node.onclick = checkPageExistsAndRedirect;
      // Add dataset values for the version and name in case people want
      // to apply CSS styling based on this information.
      node.dataset["versionName"] = entry.name;
      node.dataset["version"] = entry.version;

      $("#version_switcher_menu").append(node);
      // replace dropdown button text with the preferred display name of
      // this version, rather than using sphinx's  variable.
      // also highlight the dropdown entry for the currently-viewed
      // version's entry
      if (entry.version == "en") {
        node.classList.add("active");
        btn.innerText = btn.dataset["activeVersionName"] = entry.name;
        btn.dataset["activeVersion"] = entry.version;
      }
    });
  })();
</script>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="ml-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://play.fortran-lang.org/">
  Play
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../">
  Learn
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../compilers/">
  Compilers
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../community/">
  Community
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../packages/">
  Packages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../news/">
  News
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://fortran-lang.discourse.group/" rel="noopener" target="_blank" title="Discourse"><span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/fortranlang" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/fortran-lang" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://fortran-lang.org/en/news/atom.xml" rel="noopener" target="_blank" title="RSS"><span><i class="fas fa-rss"></i></span>
            <label class="sr-only">RSS</label></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search" aria-label="Search" autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../os_setup/">
   Setting up your OS
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../os_setup/choose_compiler/">
     Choosing a compiler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../os_setup/install_gfortran/">
     Installing GFortran
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../os_setup/text_editors/">
     Text Editors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../os_setup/ides/">
     IDEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../os_setup/tips/">
     Smart Tips
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../quickstart/">
   Quickstart tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/hello_world/">
     Hello world
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/variables/">
     Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/arrays_strings/">
     Arrays and strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/operators_control_flow/">
     Operators and flow control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/organising_code/">
     Organising code structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../quickstart/derived_types/">
     Derived Types
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../">
   Building programs
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../compiling_source/">
     Compiling the source code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linking_pieces/">
     Linking the objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../runtime_libraries/">
     Run-time libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../include_files/">
     Include files and modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../managing_libraries/">
     Managing libraries (static and dynamic libraries)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Build tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../project_make/">
     An introduction to make
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../distributing/">
     Distributing your programs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../best_practices/">
   Fortran Best Practices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/style_guide/">
     Fortran Style Guide
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/floating_point/">
     Floating Point Numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/integer_division/">
     Integer Division
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/modules_programs/">
     Modules and Programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/arrays/">
     Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/multidim_arrays/">
     Multidimensional Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/element_operations/">
     Element-wise Operations on Array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/allocatable_arrays/">
     Allocatable Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/file_io/">
     File Input/Output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/callbacks/">
     Callbacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../best_practices/type_casting/">
     Type Casting in Callbacks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../intrinsics/">
   Fortran Intrinsics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/array/">
     Properties and attributes of arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/bit/">
     Bit-level inquiry and manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/character/">
     Basic procedures for manipulating
     <em>
      character
     </em>
     variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/compiler/">
     Information about compiler and compiler options used for building
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/cfi/">
     Procedures for binding to C interfaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/math/">
     General mathematical functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/model/">
     Controlling and querying the current numeric model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/numeric/">
     Manipulation and properties of numeric values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/parallel/">
     Parallel programming using co_arrays and co_indexed arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/state/">
     General and miscellaneous intrinsics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/system/">
     Accessing external system information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/transform/">
     Matrix multiplication, dot product, and array shifts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../intrinsics/type/">
     Types and kinds
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">
     GNU Free Documentation License
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
        
<br />

<div class="tocsection onthispage">
  <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav" class="page-toc"><ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-make-as-build-tool">
   Using make as build tool
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursively-expanded-variables">
     Recursively expanded variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comments-and-whitespace">
     Comments and whitespace
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-meson-build-system">
   The meson build system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-cmake-project">
   Creating a CMake project
  </a>
 </li>
</ul>
</nav> 
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                 <section class="tex2jax_ignore mathjax_ignore" id="build-tools">
<h1>Build tools<a class="headerlink" href="#build-tools" title="Permalink to this heading">#</a></h1>
<p>Compiling your Fortran projects by hand can become quite complicated depending
on the number of source files and the interdependencies through the module.
Supporting different compilers and linkers or different platforms can become
increasingly complicated unless the right tools are used to automatically
perform those tasks.</p>
<p>Depending on the size of your project and the purpose of project different
options for the build automation can be used.</p>
<p>First, your integrated development environment probably provides a way to build
your program. A popular cross-platform tool is Microsoft’s
<a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio Code</a>,
but others exist, such as
<a href="https://atom.io/" target="_blank" rel="noopener">Atom</a>,
<a href="https://www.eclipse.org/photran/" target="_blank" rel="noopener">Eclipse Photran</a>,
and <a href="http://www.codeblocks.org/" target="_blank" rel="noopener">Code::Blocks</a>.
They offer a graphical user-interface, but are often very specific for the
compiler and platform.</p>
<p>For smaller projects, the rule based build system <code class="docutils literal notranslate"><span class="pre">make</span></code> is a common
choice. Based on the rules defined it can perform task like (re)compiling
object files from updated source files, creating libraries and linking
executables.
To use <code class="docutils literal notranslate"><span class="pre">make</span></code> for your project you have to encode those rules in <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>,
which defines the interdependencies of all the final program, the intermediary
object files or libraries and the actual source files.
For a short introduction see <a class="reference internal" href="#using-make-as-build-tool"><span class="std std-doc">the guide on <code class="docutils literal notranslate"><span class="pre">make</span></code></span></a>.</p>
<p>Maintenance tools like autotools and CMake can generate Makefiles or
Visual Studio project files via a high-level description. They abstract
away from the compiler and platform specifics.</p>
<p>Which of those tools are the best choice for your projects depends on many factors.
Choose a build tool you are comfortable working with, it should not get in your
way while developing. Spending more time on working against your build tools
than doing actual development work can quickly become frustrating.</p>
<p>Also, consider the accessibility of your build tools.
If it is restricted to a specific integrated development environment, can all
developers on your project access it?
If you are using a specific build system, does it work on all platforms you
are developing for?
How large is the entry barrier of your build tools? Consider the learning curve
for the build tools, the perfect build tool will be of no use, if you have to
learn a complex programming language first to add a new source file.
Finally, consider what other project are using, those you are depending on and
those that use (or will use) your project as dependency.</p>
<section id="using-make-as-build-tool">
<h2>Using make as build tool<a class="headerlink" href="#using-make-as-build-tool" title="Permalink to this heading">#</a></h2>
<p>The most well-known and commonly used build system is called <code class="docutils literal notranslate"><span class="pre">make</span></code>.
It performs actions following rules defined in a configuration file
called <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> or <code class="docutils literal notranslate"><span class="pre">makefile</span></code>, which usually leads to compiling a program
from the provided source code.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For an in-depth <code class="docutils literal notranslate"><span class="pre">make</span></code> tutorial lookup its info page. There is an online version of this <a href="https://www.gnu.org/software/make/manual/make.html" target="_blank" rel="noopener">info page</a>, available.</p>
</div>
<p>We will start with the basics from your clean source directory. Create and open
the file <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, we start with a simple rule called <em>all</em>:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nf">all</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>After saving the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> run it by executing <code class="docutils literal notranslate"><span class="pre">make</span></code> in the same directory.
You should see the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;all&quot;
all
</pre></div>
</div>
<p>First, we note that <code class="docutils literal notranslate"><span class="pre">make</span></code> is substituting <code class="docutils literal notranslate"><span class="pre">$&#64;</span></code> for the name of the rule,
the second thing to note is that <code class="docutils literal notranslate"><span class="pre">make</span></code> is always printing the command it is
running, finally, we see the result of running <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;all&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We call the entry point of our <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> always <em>all</em> by convention, but you can choose whatever name you like.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should not have noticed it if your editor is working correctly,
but you have to indent the content of a rule with a tab character.
In case you have problems running the above <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> and see an error like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Makefile:2: *** missing separator.  Stop.
</pre></div>
</div>
<p>The indentation is probably not correct. In this case replace the indentation
in the second line with a tab character.</p>
</div>
<p>Now we want to make our rules more complicated, therefore we add another rule:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">PROG</span> <span class="o">:=</span> my_prog

<span class="nf">all</span><span class="o">:</span> <span class="k">$(</span><span class="nv">PROG</span><span class="k">)</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2"> depends on </span>$<span class="s2">^&quot;</span>

<span class="nf">$(PROG)</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Note how we declare variables in <code class="docutils literal notranslate"><span class="pre">make</span></code>, you should always declare your local
variables with <code class="docutils literal notranslate"><span class="pre">:=</span></code>. To access the content of a variable we use the <code class="docutils literal notranslate"><span class="pre">$(...)</span></code>,
note that we have to enclose the variable name in parenthesis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The declaration of variables is usually done with <code class="docutils literal notranslate"><span class="pre">:=</span></code>, but <code class="docutils literal notranslate"><span class="pre">make</span></code> does
support <em>recursively expanded</em> variables as well with <code class="docutils literal notranslate"><span class="pre">=</span></code>.
Normally, the first kind of declaration is wanted, as they are more predictable
and do not have a runtime overhead from the recursive expansion.</p>
</div>
<p>We introduced a dependency of the rule all, namely the content of the variable
<code class="docutils literal notranslate"><span class="pre">PROG</span></code>, also we modified the printout, we want to see all the dependencies
of this rule, which are stored in the variable <code class="docutils literal notranslate"><span class="pre">$^</span></code>.
Now for the new rule which we name after the value of the variable <code class="docutils literal notranslate"><span class="pre">PROG</span></code>,
it does the same thing we did before for the rule <em>all</em>, note how the value
of <code class="docutils literal notranslate"><span class="pre">$&#64;</span></code> is dependent on the rule it is used in.</p>
<p>Again check by running the <code class="docutils literal notranslate"><span class="pre">make</span></code>, you should see:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;my_prog&quot;
my_prog
echo &quot;all depends on my_prog&quot;
all depends on my_prog
</pre></div>
</div>
<p>The dependency has been correctly resolved and evaluated before performing
any action on the rule <em>all</em>.
Let’s run only the second rule: type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">my_prog</span></code> and you will only find
the first two lines in your terminal.</p>
<p>The next step is to perform some real actions with <code class="docutils literal notranslate"><span class="pre">make</span></code>, we take
the source code from the previous chapter here and add new rules to our
<code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">OBJS</span> <span class="o">:=</span> tabulate.o functions.o
<span class="nv">PROG</span> <span class="o">:=</span> my_prog

<span class="nf">all</span><span class="o">:</span> <span class="k">$(</span><span class="nv">PROG</span><span class="k">)</span>

<span class="nf">$(PROG)</span><span class="o">:</span> <span class="k">$(</span><span class="nv">OBJS</span><span class="k">)</span>
	gfortran -o <span class="nv">$@</span> $^

<span class="nf">$(OBJS)</span><span class="o">:</span> %.<span class="n">o</span>: %.<span class="n">f</span>90
	gfortran -c -o <span class="nv">$@</span> $&lt;
</pre></div>
</div>
<p>We define <code class="docutils literal notranslate"><span class="pre">OBJS</span></code> which stands for object files, our program depends on
those <code class="docutils literal notranslate"><span class="pre">OBJS</span></code> and for each object file we create a rule to make them from
a source file.
The last rule we introduced is a pattern matching rule, <code class="docutils literal notranslate"><span class="pre">%</span></code> is the common
pattern between <code class="docutils literal notranslate"><span class="pre">tabulate.o</span></code> and <code class="docutils literal notranslate"><span class="pre">tabulate.f90</span></code>, which connects our object file
<code class="docutils literal notranslate"><span class="pre">tabulate.o</span></code> to the source file <code class="docutils literal notranslate"><span class="pre">tabulate.f90</span></code>.
With this set, we run our compiler, here <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> and translate the source
file into an object file, we do not create an executable yet due to the <code class="docutils literal notranslate"><span class="pre">-c</span></code>
flag.
Note the usage of the <code class="docutils literal notranslate"><span class="pre">$&lt;</span></code> for the first element of the dependencies here.</p>
<p>After compiling all the object files we attempt to link the program, we do not
use a linker directly, but <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> to produce the executable.</p>
<p>Now we run the build script with <code class="docutils literal notranslate"><span class="pre">make</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gfortran -c -o tabulate.o tabulate.f90
tabulate.f90:2:7:

    2 |    use user_functions
      |       1
Fatal Error: Cannot open module file ‘user_functions.mod’ for reading at (1): No such file or directory
compilation terminated.
make: *** [Makefile:10: tabulate.f90.o] Error 1
</pre></div>
</div>
<p>We remember that we have dependencies between our source files, therefore we add
this dependency explicitly to the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> with</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nf">tabulate.o</span><span class="o">:</span> <span class="n">functions</span>.<span class="n">o</span>
</pre></div>
</div>
<p>Now we can retry and find that the build is working correctly. The output should
look like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gfortran -c -o functions.o functions.f90
gfortran -c -o tabulate.o tabulate.f90
gfortran -o my_prog tabulate.o functions.o
</pre></div>
</div>
<p>You should find <em>four</em> new files in the directory now.
Run <code class="docutils literal notranslate"><span class="pre">my_prog</span></code> to make sure everything works as expected.
Let’s run <code class="docutils literal notranslate"><span class="pre">make</span></code> again:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make: Nothing to be done for &#39;all&#39;.
</pre></div>
</div>
<p>Using the timestamps of the executable <code class="docutils literal notranslate"><span class="pre">make</span></code> was able to determine, it is
newer than both <code class="docutils literal notranslate"><span class="pre">tabulate.o</span></code> and <code class="docutils literal notranslate"><span class="pre">functions.o</span></code>, which in turn are newer than
<code class="docutils literal notranslate"><span class="pre">tabulate.f90</span></code> and <code class="docutils literal notranslate"><span class="pre">functions.f90</span></code>.
Therefore, the program is already up-to-date with the latest code and no
action has to be performed.</p>
<p>In the end, we will have a look at a complete <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>.</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="c"># Disable all of make&#39;s built-in rules (similar to Fortran&#39;s implicit none)</span>
<span class="nv">MAKEFLAGS</span> <span class="o">+=</span> --no-builtin-rules --no-builtin-variables
<span class="c"># configuration</span>
<span class="nv">FC</span> <span class="o">:=</span> gfortran
<span class="nv">LD</span> <span class="o">:=</span> <span class="k">$(</span>FC<span class="k">)</span>
<span class="nv">RM</span> <span class="o">:=</span> rm -f
<span class="c"># list of all source files</span>
<span class="nv">SRCS</span> <span class="o">:=</span> tabulate.f90 functions.f90
<span class="nv">PROG</span> <span class="o">:=</span> my_prog

<span class="nv">OBJS</span> <span class="o">:=</span> <span class="k">$(</span>addsuffix .o, <span class="k">$(</span>SRCS<span class="k">))</span>

<span class="nf">.PHONY</span><span class="o">:</span> <span class="n">all</span> <span class="n">clean</span>
<span class="nf">all</span><span class="o">:</span> <span class="k">$(</span><span class="nv">PROG</span><span class="k">)</span>

<span class="nf">$(PROG)</span><span class="o">:</span> <span class="k">$(</span><span class="nv">OBJS</span><span class="k">)</span>
	<span class="k">$(</span>LD<span class="k">)</span> -o <span class="nv">$@</span> $^

<span class="nf">$(OBJS)</span><span class="o">:</span> %.<span class="n">o</span>: %
	<span class="k">$(</span>FC<span class="k">)</span> -c -o <span class="nv">$@</span> $&lt;

<span class="c"># define dependencies between object files</span>
<span class="nf">tabulate.f90.o</span><span class="o">:</span> <span class="n">functions</span>.<span class="n">f</span>90.<span class="n">o</span> <span class="n">user_functions</span>.<span class="n">mod</span>

<span class="c"># rebuild all object files in case this Makefile changes</span>
<span class="nf">$(OBJS)</span><span class="o">:</span> <span class="k">$(</span><span class="nv">MAKEFILE_LIST</span><span class="k">)</span>

<span class="nf">clean</span><span class="o">:</span>
	<span class="k">$(</span>RM<span class="k">)</span> <span class="k">$(</span>filter %.o, <span class="k">$(</span>OBJS<span class="k">))</span> <span class="k">$(</span>wildcard *.mod<span class="k">)</span> <span class="k">$(</span>PROG<span class="k">)</span>
</pre></div>
</div>
<p>Since you are starting with <code class="docutils literal notranslate"><span class="pre">make</span></code> we highly recommend to always include
the first line, like with Fortran’s <code class="docutils literal notranslate"><span class="pre">implicit</span> <span class="pre">none</span></code> we do not want to have
implicit rules messing up our <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> in surprising and harmful ways.</p>
<p>Next, we have a configuration section where we define variables, in case you
want to switch out your compiler, it can be easily done here.
We also introduced the <code class="docutils literal notranslate"><span class="pre">SRCS</span></code> variable to hold all source files, which is
more intuitive than specifying object files.
We can easily create the object files by appending a <code class="docutils literal notranslate"><span class="pre">.o</span></code> suffix using the
functions <code class="docutils literal notranslate"><span class="pre">addsuffix</span></code>.
The <code class="docutils literal notranslate"><span class="pre">.PHONY</span></code> is a special rule, which should be used for all entry points
of your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, here we define two entry point, we already know <em>all</em>,
the new <em>clean</em> rule deletes all the build artifacts again such that we indeed
start with a clean directory.</p>
<p>Also, we slightly changed the build rule for the object files to account for
appending the <code class="docutils literal notranslate"><span class="pre">.o</span></code> suffix instead of substituting it.
Notice that we still need to explicitly define the interdependencies in the
<code class="docutils literal notranslate"><span class="pre">Makefile</span></code>. We also added a dependency for the object files on the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>
itself, in case you change the compiler, this will allow you to safely rebuild.</p>
<p>Now you know enough about <code class="docutils literal notranslate"><span class="pre">make</span></code> to use it for building small projects.
If you plan to use <code class="docutils literal notranslate"><span class="pre">make</span></code> more extensively, we have compiled a few tips
for you as well.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In this guide, we avoided and disabled a lot of the commonly used <code class="docutils literal notranslate"><span class="pre">make</span></code>
features that can be particularly troublesome if not used correctly, we highly
recommend staying away from the builtin rules and variables if you do not feel
confident working with <code class="docutils literal notranslate"><span class="pre">make</span></code>, but explicitly declare all variables and rules.</p>
<p>You will find that <code class="docutils literal notranslate"><span class="pre">make</span></code> is capable tool to automate short interdependent
workflows and to build small projects. But for larger projects, you will
probably soon run against some of it limitations. Usually, <code class="docutils literal notranslate"><span class="pre">make</span></code> is therefore
not used alone but combined with other tools to generate the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>
completely or in parts.</p>
</div>
<section id="recursively-expanded-variables">
<h3>Recursively expanded variables<a class="headerlink" href="#recursively-expanded-variables" title="Permalink to this heading">#</a></h3>
<p>Commonly seen in many projects are recursively expanded variables (declared with
<code class="docutils literal notranslate"><span class="pre">=</span></code> instead of <code class="docutils literal notranslate"><span class="pre">:=</span></code>). Recursive expansion of your variables allows out-of-order
declaration and other neat tricks with <code class="docutils literal notranslate"><span class="pre">make</span></code>, since they are defined as rules,
which are expanded at runtime, rather than being defined while parsing.</p>
<p>For example, declaring and using your Fortran flags with this snippet will work
completely fine:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nf">all</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="k">$(</span>FFLAGS<span class="k">)</span>

<span class="nv">FFLAGS</span> <span class="o">=</span> <span class="k">$(</span>include_dirs<span class="k">)</span> -O
<span class="nv">include_dirs</span> <span class="o">+=</span> -I./include
<span class="nv">include_dirs</span> <span class="o">+=</span> -I/opt/some_dep/include
</pre></div>
</div>
<p>You should find the expected (or maybe unexpected) printout after running <code class="docutils literal notranslate"><span class="pre">make</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo -I./include -I/opt/some_dep/include -O
-I./include -I/opt/some_dep/include -O
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>appending with <code class="docutils literal notranslate"><span class="pre">+=</span></code> to an undefined variable will produce a recursively expanded variable with this state being inherited for all further appending.</p>
</div>
<p>While, it seems like an interesting feature to use, it tends to lead to
surprising and unexpected outcomes. Usually, when defining variables like your
compiler, there is little reason to actually use the recursive expansion at all.</p>
<p>The same can easily be achieved using the <code class="docutils literal notranslate"><span class="pre">:=</span></code> declaration:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nf">all</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="k">$(</span>FFLAGS<span class="k">)</span>

<span class="nv">include_dirs</span> <span class="o">:=</span> -I./include
<span class="nv">include_dirs</span> <span class="o">+=</span> -I/opt/some_dep/include
<span class="nv">FFLAGS</span> <span class="o">:=</span> <span class="k">$(</span>include_dirs<span class="k">)</span> -O
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>always think of a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> as a whole set of rules, it must be parsed completely before any rule can be evaluated.</p>
</div>
<p>You can use whatever kind of variables you like most, mixing them should be done
carefully, of course. It is important to be aware of the differences between the
two kinds and the respective implications.</p>
</section>
<section id="comments-and-whitespace">
<h3>Comments and whitespace<a class="headerlink" href="#comments-and-whitespace" title="Permalink to this heading">#</a></h3>
<p>There are some caveats with whitespace and comments, which might pop up from
time to time when using <code class="docutils literal notranslate"><span class="pre">make</span></code>. First, <code class="docutils literal notranslate"><span class="pre">make</span></code> does not know of any data
type except for strings and the default separator is just a space.
This means <code class="docutils literal notranslate"><span class="pre">make</span></code> will give a hard time trying to build a project which
has spaces in file names. If you encounter such case, renaming the file
is possibly the easiest solution at hand.</p>
<p>Another common problem is leading and trailing whitespace, once introduced,
<code class="docutils literal notranslate"><span class="pre">make</span></code> will happily carry it along and it does in fact make a difference
when comparing strings in <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
<p>Those can be introduced by comments like</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">prefix</span> <span class="o">:=</span> /usr  <span class="c1"># path to install location</span>
<span class="nf">install</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="k">$(</span>prefix<span class="k">)</span><span class="s2">/lib&quot;</span>
</pre></div>
</div>
<p>While the comment will be correctly removed by <code class="docutils literal notranslate"><span class="pre">make</span></code>, the trailing two spaces
are now part of the variable content. Run <code class="docutils literal notranslate"><span class="pre">make</span></code> and check that this is indeed
the case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;/usr  /lib&quot;</span>
<span class="o">/</span><span class="n">usr</span>  <span class="o">/</span><span class="n">lib</span>
</pre></div>
</div>
<p>To solve this issue, you can either move the comment, or strip the whitespace with
the <code class="docutils literal notranslate"><span class="pre">strip</span></code> function instead. Alternatively, you could try to <code class="docutils literal notranslate"><span class="pre">join</span></code> the
strings.</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">prefix</span> <span class="o">:=</span> /usr  <span class="c1"># path to install location</span>
<span class="nf">install</span><span class="o">:</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="k">$(</span>strip <span class="k">$(</span>prefix<span class="k">))</span><span class="s2">/lib&quot;</span>
	<span class="nb">echo</span> <span class="s2">&quot;</span><span class="k">$(</span>join <span class="k">$(</span>join <span class="k">$(</span>prefix<span class="k">)</span>, /<span class="k">)</span>, lib<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>All in all, none of this solutions will make your <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> more readable,
therefore, it is prudent to pay extra attention to whitespace and comments when
writing and using <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
</section>
</section>
<section id="the-meson-build-system">
<h2>The meson build system<a class="headerlink" href="#the-meson-build-system" title="Permalink to this heading">#</a></h2>
<p>After you have learned the basics of <code class="docutils literal notranslate"><span class="pre">make</span></code>, which we call a low-level build
system, we will introduce <code class="docutils literal notranslate"><span class="pre">meson</span></code>, a high-level build system.
While you specify in a low-level build system how to build your program,
you can use a high-level build system to specify what to build.
A high-level build system will deal for you with how and generate
build files for a low-level build system.</p>
<p>There are plenty of high-level build systems available, but we will focus on
<code class="docutils literal notranslate"><span class="pre">meson</span></code> because it is constructed to be particularly user friendly.
The default low-level build-system of <code class="docutils literal notranslate"><span class="pre">meson</span></code> is called <code class="docutils literal notranslate"><span class="pre">ninja</span></code>.</p>
<p>Let’s have a look at a complete <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file:</p>
<!-- meson is unknown by the highlighter, python looks okayish -->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;my_proj&#39;</span><span class="p">,</span> <span class="s1">&#39;fortran&#39;</span><span class="p">,</span> <span class="n">meson_version</span><span class="p">:</span> <span class="s1">&#39;&gt;=0.49&#39;</span><span class="p">)</span>
<span class="n">executable</span><span class="p">(</span><span class="s1">&#39;my_prog&#39;</span><span class="p">,</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;tabulate.f90&#39;</span><span class="p">,</span> <span class="s1">&#39;functions.f90&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>And we are already done, the next step is to configure our low-level build system
with <code class="docutils literal notranslate"><span class="pre">meson</span> <span class="pre">setup</span> <span class="pre">build</span></code>, you should see output somewhat similar to this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The Meson build system
Version: 0.53.2
Source dir: /home/awvwgk/Examples
Build dir: /home/awvwgk/Examples/build
Build type: native build
Project name: my_proj
Project version: undefined
Fortran compiler for the host machine: gfortran (gcc 9.2.1 &quot;GNU Fortran (Arch Linux 9.2.1+20200130-2) 9.2.1 20200130&quot;)
Fortran linker for the host machine: gfortran ld.bfd 2.34
Host machine cpu family: x86_64
Host machine cpu: x86_64
Build targets in project: 1

Found ninja-1.10.0 at /usr/bin/ninja
</pre></div>
</div>
<p>The provided information at this point is already more detailed than anything
we could have provided in a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, let’s run the build with
<code class="docutils literal notranslate"><span class="pre">ninja</span> <span class="pre">-C</span> <span class="pre">build</span></code>, which should show something like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[1/4] Compiling Fortran object &#39;my_prog@exe/functions.f90.o&#39;.
[2/4] Dep hack
[3/4] Compiling Fortran object &#39;my_prog@exe/tabulate.f90.o&#39;.
[4/4] Linking target my_prog.
</pre></div>
</div>
<p>Find and test your program at <code class="docutils literal notranslate"><span class="pre">build/my_prog</span></code> to ensure it works correctly.
We note the steps <code class="docutils literal notranslate"><span class="pre">ninja</span></code> performed are the same we would have coded up in a
<code class="docutils literal notranslate"><span class="pre">Makefile</span></code> (including the dependency), yet we did not have to specify them,
have a look at your <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file again:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;my_proj&#39;</span><span class="p">,</span> <span class="s1">&#39;fortran&#39;</span><span class="p">,</span> <span class="n">meson_version</span><span class="p">:</span> <span class="s1">&#39;&gt;=0.49&#39;</span><span class="p">)</span>
<span class="n">executable</span><span class="p">(</span><span class="s1">&#39;my_prog&#39;</span><span class="p">,</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;tabulate.f90&#39;</span><span class="p">,</span> <span class="s1">&#39;functions.f90&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We only specified that we have a Fortran project (which happens to require
a certain version of <code class="docutils literal notranslate"><span class="pre">meson</span></code> for the Fortran support) and told <code class="docutils literal notranslate"><span class="pre">meson</span></code>
to build an executable <code class="docutils literal notranslate"><span class="pre">my_prog</span></code> from the files <code class="docutils literal notranslate"><span class="pre">tabulate.f90</span></code> and
<code class="docutils literal notranslate"><span class="pre">functions.f90</span></code>.
We had not to tell <code class="docutils literal notranslate"><span class="pre">meson</span></code> how to build the project, it figured this out
by itself.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">meson</span></code> is a cross-platform build system, the project you just specified
for your program can be used to compile binaries for your native operating
system or to cross-compile your project for other platforms.
Similarly, the <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> file is portable and will work on different
platforms as well.</p>
</div>
<p>The documentation of <code class="docutils literal notranslate"><span class="pre">meson</span></code> can be found at the
<a href="https://mesonbuild.com/" target="_blank" rel="noopener">meson-build webpage</a>.</p>
</section>
<section id="creating-a-cmake-project">
<h2>Creating a CMake project<a class="headerlink" href="#creating-a-cmake-project" title="Permalink to this heading">#</a></h2>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">meson</span></code> CMake is a high-level build system as well and commonly
used to build Fortran projects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CMake follows a slightly different strategy and provides you with a complete
programming language to create your build files.
This is has the advantage that you can do almost everything with CMake,
but your CMake build files can also become as complex as the program you are
building.</p>
</div>
<p>Start by creating the file <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> with the content</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.7</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s2">&quot;my_proj&quot;</span><span class="w"> </span><span class="s">LANGUAGES</span><span class="w"> </span><span class="s2">&quot;Fortran&quot;</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s2">&quot;my_prog&quot;</span><span class="w"> </span><span class="s2">&quot;tabulate.f90&quot;</span><span class="w"> </span><span class="s2">&quot;functions.f90&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">meson</span></code> we are already done with our CMake build file.
We configure our low-level build files with <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">-B</span> <span class="pre">build</span> <span class="pre">-G</span> <span class="pre">Ninja</span></code>,
you should see output similar to this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-- The Fortran compiler identification is GNU 10.2.0
-- Detecting Fortran compiler ABI info
-- Detecting Fortran compiler ABI info - done
-- Check for working Fortran compiler: /usr/bin/f95 - skipped
-- Checking whether /usr/bin/f95 supports Fortran 90
-- Checking whether /usr/bin/f95 supports Fortran 90 - yes
-- Configuring done
-- Generating done
-- Build files have been written to: /home/awvwgk/Examples/build
</pre></div>
</div>
<p>You might be surprised that CMake tries to use the compiler <code class="docutils literal notranslate"><span class="pre">f95</span></code>, fortunately
this is just a symbolic link to <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> on most systems and not the actual
<code class="docutils literal notranslate"><span class="pre">f95</span></code> compiler.
To give CMake a better hint you can export the environment variable <code class="docutils literal notranslate"><span class="pre">FC=gfortran</span></code>
rerunning should show the correct compiler name now</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-- The Fortran compiler identification is GNU 10.2.0
-- Detecting Fortran compiler ABI info
-- Detecting Fortran compiler ABI info - done
-- Check for working Fortran compiler: /usr/bin/gfortran - skipped
-- Checking whether /usr/bin/gfortran supports Fortran 90
-- Checking whether /usr/bin/gfortran supports Fortran 90 - yes
-- Configuring done
-- Generating done
-- Build files have been written to: /home/awvwgk/Example/build
</pre></div>
</div>
<p>In a similar manner you could use your Intel Fortran compiler instead to build
your project (set <code class="docutils literal notranslate"><span class="pre">FC=ifort</span></code>).</p>
<p>CMake provides support for several low-level build files, since the default is
platform specific, we will just use <code class="docutils literal notranslate"><span class="pre">ninja</span></code> since we already used it together
with <code class="docutils literal notranslate"><span class="pre">meson</span></code>. As before, build your project with <code class="docutils literal notranslate"><span class="pre">ninja</span> <span class="pre">-C</span> <span class="pre">build</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[1/6] Building Fortran preprocessed CMakeFiles/my_prog.dir/functions.f90-pp.f90
[2/6] Building Fortran preprocessed CMakeFiles/my_prog.dir/tabulate.f90-pp.f90
[3/6] Generating Fortran dyndep file CMakeFiles/my_prog.dir/Fortran.dd
[4/6] Building Fortran object CMakeFiles/my_prog.dir/functions.f90.o
[5/6] Building Fortran object CMakeFiles/my_prog.dir/tabulate.f90.o
[6/6] Linking Fortran executable my_prog
</pre></div>
</div>
<p>Find and test your program at <code class="docutils literal notranslate"><span class="pre">build/my_prog</span></code> to ensure it works correctly.
The steps <code class="docutils literal notranslate"><span class="pre">ninja</span></code> performed are somewhat different, because there is usually
more than one way to write the low-level build files to accomplish the task
of building a project. Fortunately, we do not have to concern ourselves but have
our build system handle those details for us.</p>
<p>Finally, we will shortly recap on our complete <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> to specify
our project:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.7</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s2">&quot;my_proj&quot;</span><span class="w"> </span><span class="s">LANGUAGES</span><span class="w"> </span><span class="s2">&quot;Fortran&quot;</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s2">&quot;my_prog&quot;</span><span class="w"> </span><span class="s2">&quot;tabulate.f90&quot;</span><span class="w"> </span><span class="s2">&quot;functions.f90&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We specified that we have a Fortran project and told CMake to create an executable
<code class="docutils literal notranslate"><span class="pre">my_prog</span></code> from the files <code class="docutils literal notranslate"><span class="pre">tabulate.f90</span></code> and <code class="docutils literal notranslate"><span class="pre">functions.f90</span></code>.
CMake knows the details how to build the executable from the specified sources,
so we do not have to worry about the actual steps in the build process.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>CMake’s official reference can be found at the
&lt;a href=”https://cmake.org/cmake/help/latest/”, target=”_blank” rel=”noopener”&gt;CMake webpage</a>.
It is organised in manpages, which are also available with your local CMake
installation as well using <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">cmake</span></code>. While it covers all functionality of
CMake, it sometimes covers them only very briefly.</p>
</div>
</section>
</section>

<div class="section">
   
</div>

              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2020-2022, Fortran Community.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>